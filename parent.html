<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Parent Dashboard</title>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore.js"></script>
</head>
<body>
  <h1>Parent Dashboard</h1>
  <input id="childAdm" placeholder="Admission No">
  <button onclick="addChild()">Add Child</button>
  <ul id="childList"></ul>

  <div id="childData"></div>

  <script src="firebase.js"></script>
  <script>
    let children = [];
    function addChild() {
      const adm = document.getElementById('childAdm').value;
      children.push(adm);
      renderChildren();
    }
    function renderChildren() {
      let list = '';
      children.forEach(adm => {
        list += '<li onclick="showChild(\''+adm+'\')">'+adm+'</li>';
      });
      document.getElementById('childList').innerHTML = list;
    }
    function showChild(adm) {
      let out = '<h3>Child: '+adm+'</h3>';
      db.collection('results').doc(adm).get().then(doc => {
        out += doc.exists ? '<p>Marks: '+doc.data().marks+'</p>' : '<p>No results</p>';
        return db.collection('fees').doc(adm).get();
      }).then(doc => {
        out += doc.exists ? '<p>Balance: '+doc.data().balance+'</p>' : '<p>No fee record</p>';
        document.getElementById('childData').innerHTML = out;
      });
    }
  </script>
</body>
</html>
